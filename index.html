<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>å…ƒå…ƒå·¥ä½œåŠ©æ‰‹</title>
    <!-- å¿…é¡»å…ˆå¼•å…¥vueï¼Œ  åä½¿ç”¨element-ui -->
    <script src="https://cdn.staticfile.org/vue/2.7.0/vue.min.js"></script>
    <!--å¼•å…¥ element-ui çš„æ ·å¼ï¼Œ-->
    <link rel="stylesheet" href="https://unpkg.com/element-ui/lib/theme-chalk/index.css">
    <!-- å¼•å…¥element çš„ç»„ä»¶åº“-->
    <script src="https://unpkg.com/element-ui/lib/index.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/jszip/3.5.0/jszip.min.js"></script>
    <script src="https://cdn.bootcdn.net/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
    <script lang="javascript" src="https://cdn.sheetjs.com/xlsx-0.20.1/package/dist/xlsx.full.min.js"></script>
</head>

<body>
    <div id="app">
        <el-radio-group v-model="type">
            <el-radio-button label="0">æ—¥æŠ¥</el-radio-button>
            <el-radio-button label="1">æ•°æ®</el-radio-button>
        </el-radio-group>
        <div style="width: 100%;height:1px;background-color: gray;margin:1rem 0"></div>
        <el-row v-show="type==='0'">
            <el-row>
                <el-date-picker v-model="chooseDate" type="date" placeholder="é€‰æ‹©æ—¥æœŸ" @change="clickDateEveryDay">
                </el-date-picker>
            </el-row>
            <div style="width: 100%;height:1px;margin: 10px 0;"></div>
            <el-row style="background-color: rgb(243, 209, 209);">
                <el-col :span="3"><el-link :href="linkDay.rblink1" target="_blank"
                        v-show="linkDay.rblink1">ç¬¬ä¸€æ­¥</el-link></el-col>
                <el-col :span="3"><el-link :href="linkDay.rblink2" target="_blank"
                        v-show="linkDay.rblink2">ç¬¬äºŒæ­¥</el-link></el-col>
                <el-col :span="3"><el-link :href="linkDay.rblink3" target="_blank"
                        v-show="linkDay.rblink3">ç¬¬ä¸‰æ­¥</el-link></el-col>
            </el-row>
            <el-row>
                <el-col :span="6"><el-button @click="rivbaoOutput">è¾“å‡º</el-button></el-col>
            </el-row>
            <el-row style="margin-top: 10px;">
                <el-col :span="24"><el-input v-model="ribaoMessage1" placeholder="è¯·è¾“å…¥ç¬¬ä¸€æ­¥"></el-input></el-col>
            </el-row>
            <el-row style="margin-top: 10px;">
                <el-col :span="24"><el-input v-model="ribaoMessage2" placeholder="è¯·è¾“å…¥ç¬¬äºŒæ­¥"></el-input></el-col>
            </el-row>
            <el-row style="margin-top: 10px;">
                <el-col :span="24"><el-input v-model="ribaoMessage3" placeholder="è¯·è¾“å…¥ç¬¬ä¸‰æ­¥"></el-input></el-col>
            </el-row>
            <div style="width: 100%;height:1px;background-color:orange;margin: 20px 0;"></div>
            <el-row style="background-color:green;">é‡‘é¢</el-row>
            <el-row>
                <el-col :span="24">
                    <el-table :data="ribaoTableData" style="width: 100%">
                        <el-table-column prop="date" label="æ—¥æœŸ" width="180">
                        </el-table-column>
                        <el-table-column prop="qdcje" label="å…¨åº—æˆäº¤é¢">
                        </el-table-column>
                        <el-table-column prop="spcje" label="è§†é¢‘æˆäº¤é¢">
                        </el-table-column>
                        <el-table-column prop="spzb" label="è§†é¢‘å å…¨åº—æˆäº¤é¢(100%)">
                        </el-table-column>
                        <el-table-column prop="twcje" label="å›¾æ–‡æˆäº¤é¢">
                        </el-table-column>
                        <el-table-column prop="twzb" label="å›¾æ–‡å å…¨åº—æˆäº¤é¢(100%)">
                        </el-table-column>
                        <el-table-column prop="hjcje" label="åˆè®¡æˆäº¤é¢">
                        </el-table-column>
                        <el-table-column prop="hjzb" label="åˆè®¡å å…¨åº—æˆäº¤é¢(100%)">
                        </el-table-column>
                    </el-table>
                </el-col>
            </el-row>
            <div style="width: 100%;height:1px;background-color:orange;margin: 20px 0;"></div>
            <el-row style="background-color:pink;">è®¿å®¢</el-row>
            <el-row>
                <el-col :span="24">
                    <el-table :data="ribaoTableData" style="width: 100%">
                        <el-table-column prop="date" label="æ—¥æœŸ" width="180">
                        </el-table-column>
                        <el-table-column prop="qdfk" label="å…¨åº—è®¿å®¢">
                        </el-table-column>
                        <el-table-column prop="spfk" label="è§†é¢‘è®¿å®¢">
                        </el-table-column>
                        <el-table-column prop="spfkzb" label="è§†é¢‘å å…¨åº—è®¿å®¢(100%)">
                        </el-table-column>
                        <el-table-column prop="twfk" label="å›¾æ–‡è®¿å®¢">
                        </el-table-column>
                        <el-table-column prop="twfkzb" label="å›¾æ–‡å å…¨åº—è®¿å®¢(100%)">
                        </el-table-column>
                        <el-table-column prop="hjfk" label="åˆè®¡æˆè®¿å®¢">
                        </el-table-column>
                        <el-table-column prop="hjfkzb" label="åˆè®¡å å…¨åº—è®¿å®¢(100%)">
                        </el-table-column>
                    </el-table>
                </el-col>
            </el-row>
        </el-row>
        <el-row v-show="type==='1'">
            <el-row>
                <el-col :span="6">
                    <el-date-picker v-model="chooseDate2" type="daterange" unlink-panels align="right"
                        range-separator="è‡³" start-placeholder="å¼€å§‹æ—¥æœŸ" end-placeholder="ç»“æŸæ—¥æœŸ"
                        :picker-options="pickerOptions" @change="clickDateDay">
                    </el-date-picker>
                </el-col>
                <el-col :span="6" v-if="chooseDate2">
                    <el-tooltip class="item" effect="dark" content="âœ”å…ƒå…ƒå®æœ€æ£’ï¼" placement="top">
                        <el-button @click="dataOutput" icon="el-icon-check">è¾“å‡º</el-button>
                    </el-tooltip>
                    <el-tooltip class="item" effect="dark" content="å¦‚æœé‡åˆ°æ— æ•°æ®ï¼Œè¡¨ç¤ºå¯¼å…¥çš„excelä¸­æ²¡æœ‰è¿™ä¸ªå•†å“å“¦ï½" placement="top">
                        <el-button style="margin-left: 10px;" @click="exportFile" icon="el-icon-download">å¯¼å‡º</el-button>
                    </el-tooltip>
                </el-col>
            </el-row>
            <div style="width: 100%;height:1px;margin: 10px 0;"></div>
            <template v-if="chooseDate2">
                <el-card style="width: 100%;">
                    <div slot="header" class="clearfix">
                        <span>å“ç±»-å…¨éƒ¨å•†å“ï¼ˆâš ï¸å…ƒå…ƒå®ï¼Œæ³¨æ„å“¦è¿™é‡Œæ˜¯20æ¡ä¸€é¡µçš„ï¼‰</span>
                    </div>
                    <el-row style="padding: 8px 16px;" v-for="(item,index) in allGoodsJsons" :key="index">
                        <el-col :span="12">
                            <el-input v-model="allGoodsJsons[index]" :placeholder="`è¯·è¾“å…¥ç¬¬${index+1}é¡µ`" type="textarea"
                                :rows="2">
                                <template slot="prepend">{{`ç¬¬${index+1}é¡µ`}}</template>
                            </el-input>
                        </el-col>
                        <el-col :span="6">
                            <el-button :disabled="!!allGoodsJsons[index]"
                                @click="getThisPage('all',index)">è·å–æœ¬é¡µ</el-button>
                            <el-button @click="addPage('all')">ä¸‹ä¸€é¡µ</el-button>
                        </el-col>
                    </el-row>
                </el-card>
                <div class="box-space">
                    <el-card class="box-card">
                        <div slot="header" class="clearfix">
                            <span>å†…å®¹-å•†å®¶è‡ªåˆ¶ï¼ˆå®Œç¾æ”¯æŒæ‰¹é‡ä¸Šä¼ å“¦ï½ï¼‰</span>
                        </div>
                        <el-upload class="upload-demo" drag action="https://jsonplaceholder.typicode.com/posts/"
                            multiple :on-change="handleChangeSelf"
                            accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"
                            :auto-upload="false">
                            <i class="el-icon-upload"></i>
                            <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        </el-upload>
                    </el-card>
                    <el-card class="box-card">
                        <div slot="header" class="clearfix">
                            <span>å†…å®¹-å†…å®¹è¥é”€ï¼ˆæ²¡æƒ³åˆ°æˆ‘è¿™ä¹ˆå‰å®³å§ï½ï¼‰</span>
                        </div>
                        <el-upload class="upload-demo" drag action="https://jsonplaceholder.typicode.com/posts/"
                            multiple :on-change="handleChangeContent"
                            accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"
                            :auto-upload="false">
                            <i class="el-icon-upload"></i>
                            <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        </el-upload>
                    </el-card>
                    <el-card class="box-card">
                        <div slot="header" class="clearfix">
                            <span>å†…å®¹-ä¹°å®¶å†…å®¹ï¼ˆè¿™ä¹ˆéš¾å¾—ä¸œè¥¿éƒ½æå®šå•¦ğŸ˜Šï¼‰</span>
                        </div>
                        <el-upload class="upload-demo" drag action="https://jsonplaceholder.typicode.com/posts/"
                            multiple :on-change="handleChangeBuyer"
                            accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"
                            :auto-upload="false">
                            <i class="el-icon-upload"></i>
                            <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        </el-upload>
                    </el-card>
                    <el-card class="box-card">
                        <div slot="header" class="clearfix">
                            <span>å†…å®¹-å…¶ä»–ï¼ˆå’Œå°å…ƒå®è´´è´´ï¼‰</span>
                        </div>
                        <el-upload class="upload-demo" drag action="https://jsonplaceholder.typicode.com/posts/"
                            multiple :on-change="handleChangeOther"
                            accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet,application/vnd.ms-excel"
                            :auto-upload="false">
                            <i class="el-icon-upload"></i>
                            <div class="el-upload__text">å°†æ–‡ä»¶æ‹–åˆ°æ­¤å¤„ï¼Œæˆ–<em>ç‚¹å‡»ä¸Šä¼ </em></div>
                        </el-upload>
                    </el-card>
                </div>
                <div style="width: 100%;height:1px;background-color:orange;margin: 20px 0;"></div>
                <el-table :data="calculateTableData" style="width: 100%">
                    <el-table-column prop="productId" fixed label="å•†å“ID" width="150px">
                    </el-table-column>
                    <el-table-column prop="productName" fixed label="å•†å“åç§°" width="200px">
                    </el-table-column>
                    <el-table-column prop="payment" label="æ”¯ä»˜é‡‘é¢">
                    </el-table-column>
                    <el-table-column prop="refundAmount" label="é€€æ¬¾é‡‘é¢">
                    </el-table-column>
                    <el-table-column prop="refundAmountRate" label="é€€æ¬¾ç‡(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="allVisitor" label="æ€»è®¿å®¢æ•°">
                    </el-table-column>
                    <el-table-column prop="selfAmount" label="å•†å®¶è‡ªåˆ¶-æˆäº¤é‡‘é¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="selfAmountRate" label="å•†å®¶è‡ªåˆ¶-æˆäº¤é‡‘é¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="selfVisitor" label="å•†å®¶è‡ªåˆ¶-è®¿å®¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="selfVisitorRate" label="å•†å®¶è‡ªåˆ¶-è®¿å®¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="contentAmount" label="å†…å®¹è¥é”€-æˆäº¤é‡‘é¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="contentAmountRate" label="å†…å®¹è¥é”€-æˆäº¤é‡‘é¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="contentVisitor" label="å†…å®¹è¥é”€-è®¿å®¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="contentVisitorRate" label="å†…å®¹è¥é”€-è®¿å®¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="buyerAmount" label="ä¹°å®¶å†…å®¹-æˆäº¤é‡‘é¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="buyerAmountRate" label="ä¹°å®¶å†…å®¹-æˆäº¤é‡‘é¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="buyerVisitor" label="ä¹°å®¶å†…å®¹-è®¿å®¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="buyerVisitorRate" label="ä¹°å®¶å†…å®¹-è®¿å®¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="otherAmount" label="å…¶ä»–-æˆäº¤é‡‘é¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="otherAmountRate" label="å…¶ä»–-æˆäº¤é‡‘é¢å æ¯”(%)" width="100px">
                    </el-table-column>
                    <el-table-column prop="otherVisitor" label="å…¶ä»–-è®¿å®¢" width="100px">
                    </el-table-column>
                    <el-table-column prop="otherVisitorRate" label="å…¶ä»–-è®¿å®¢å æ¯”(%)" width="100px">
                    </el-table-column>
                </el-table>
            </template>
            <!-- <el-row>
            <el-col :span="6">
                <el-date-picker
                    v-model="datetimerange"
                    type="month"
                    placeholder="é€‰æ‹©æœˆ"
                    @change="clickDate">
                </el-date-picker>
            </el-col>
        </el-row>
        <div style="width: 100%;height:1px;margin: 10px 0;"></div>
        <el-row style="background-color: rgb(243, 209, 209);">
            <el-col :span="3"><el-link :href="link.cje" target="_blank" v-show="link.cje">æˆäº¤é¢</el-link></el-col>
            <el-col :span="3"><el-link :href="link.twmx" target="_blank" v-show="link.twmx">å›¾æ–‡æ˜ç»†</el-link></el-col>
            <el-col :span="3"><el-link :href="link.spmx" target="_blank" v-show="link.spmx">è§†é¢‘æ˜ç»†</el-link></el-col>
        </el-row>
          <el-row>
            <el-col :span="3">æˆäº¤é¢</el-col>
            <el-col :span="12"><el-input v-model="message" placeholder="è¯·è¾“å…¥å†…å®¹"></el-input></el-col>
            <el-col :span="6"><el-button @click="output">è¾“å‡º</el-button></el-col>
          </el-row>
          <el-row>
            <el-col :span="24">
                <el-table
                :data="tableData"
                style="width: 100%">
                    <el-table-column
                        prop="date"
                        label="æ—¥æœŸ"
                        width="180">
                    </el-table-column>
                    <el-table-column
                        prop="articlePay"
                        label="å›¾æ–‡æˆäº¤é¢">
                    </el-table-column>
                    <el-table-column
                        prop="videoPay"
                        label="çŸ­è§†é¢‘æˆäº¤é¢">
                    </el-table-column>
                </el-table>
            </el-col>
          </el-row>
          <div style="width: 100%;height:1px;background-color:orange;margin: 20px 0;"></div>
          <el-row>
            <el-col :span="3">å›¾æ–‡æ˜ç»†</el-col>
            <el-col :span="12"><el-input v-model="articleMessage" placeholder="è¯·è¾“å…¥å†…å®¹"></el-input></el-col>
            <el-col :span="6"><el-button @click="articleOutput">è¾“å‡º</el-button></el-col>
          </el-row>
          <el-row>
            <el-col :span="24">
                <el-table
                :data="articleTableData"
                style="width: 100%">
                    <el-table-column
                        prop="date"
                        label="æ—¥æœŸ"
                        width="180">
                    </el-table-column>
                    <el-table-column
                        prop="pvUv"
                        label="å›¾æ–‡æµé‡ï¼ˆè¿›å•†uvï¼‰"
                        width="180">
                    </el-table-column>
                    <el-table-column
                        prop="ordByrCnt"
                        label="ä¸‹å•äººæ•°">
                    </el-table-column>
                    <el-table-column
                        prop="strollPv"
                        label="å›¾æ–‡æµè§ˆé‡ï¼ˆpvï¼‰">
                    </el-table-column>
                </el-table>
            </el-col>
          </el-row>
          <div style="width: 100%;height:1px;background-color:orange;margin: 20px 0;"></div>
          <el-row>
            <el-col :span="3">è§†é¢‘æ˜ç»†</el-col>
            <el-col :span="12"><el-input v-model="videoMessage" placeholder="è¯·è¾“å…¥å†…å®¹"></el-input></el-col>
            <el-col :span="6"><el-button @click="videoOutput">è¾“å‡º</el-button></el-col>
          </el-row>
          <el-row>
            <el-col :span="24">
                <el-table
                :data="videoTableData"
                style="width: 100%">
                    <el-table-column
                    prop="date"
                    label="æ—¥æœŸ"
                    width="180">
                    </el-table-column>
                    <el-table-column
                        prop="pvUv"
                        label="è§†é¢‘æµé‡ï¼ˆè¿›å•†uvï¼‰"
                        width="180">
                    </el-table-column>
                    <el-table-column
                        prop="ordByrCnt"
                        label="ä¸‹å•äººæ•°">
                    </el-table-column>
                    <el-table-column
                        prop="strollPv"
                        label="è§†é¢‘æµè§ˆé‡ï¼ˆpvï¼‰">
                    </el-table-column>
                </el-table>
            </el-col>
          </el-row> -->
        </el-row>
    </div>
    <script type="text/javascript">
        new Vue({
            el: '#app',
            data: {
                instance: null,
                type: "0",
                message: "",
                articleMessage: "",
                videoMessage: "",
                ribaoMessage1: "",
                ribaoMessage2: "",
                ribaoMessage3: "",
                tableData: [],
                articleTableData: [],
                videoTableData: [],
                ribaoTableData: [],
                calculateTableData: [], //  æ•°æ®è®¡ç®—åçš„è¡¨æ ¼
                datetimerange: '',
                chooseDate: '',
                chooseDate2: '',
                link: {
                    cje: null,
                    twmx: null,
                    spmx: null
                },
                linkDay: {
                    rblink1: null,
                    rblink2: null,
                    rblink3: null
                },
                allGoodsParam: {
                    url: '',
                    page: 1,
                },
                allGoodsJsons: [''],
                allGoods: [],
                selfGoodsParam: {
                    url: '',
                    page: 1,
                },
                selfGoodsJsons: [],
                contentGoodsParam: {
                    url: '',
                    page: 1,
                },
                contentGoodsJsons: [],
                buyerGoodsParam: {
                    url: '',
                    page: 1,
                },
                buyerGoodsJsons: [],
                otherGoodsParam: {
                    url: '',
                    page: 1,
                },
                otherGoodsJsons: [],
                linkData: {
                    rblink1: null,
                    rblink2: null,
                    rblink3: null,
                    rblink4: null,
                    rblink5: null,
                },
                pickerOptions: {
                    shortcuts: [{
                        text: 'æœ€è¿‘ä¸€å‘¨',
                        onClick(picker) {
                            const end = new Date();
                            const start = new Date();
                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 7);
                            picker.$emit('pick', [start, end]);
                        }
                    }, {
                        text: 'æœ€è¿‘ä¸€ä¸ªæœˆ',
                        onClick(picker) {
                            const end = new Date();
                            const start = new Date();
                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 30);
                            picker.$emit('pick', [start, end]);
                        }
                    }, {
                        text: 'æœ€è¿‘ä¸‰ä¸ªæœˆ',
                        onClick(picker) {
                            const end = new Date();
                            const start = new Date();
                            start.setTime(start.getTime() - 3600 * 1000 * 24 * 90);
                            picker.$emit('pick', [start, end]);
                        }
                    }]
                },
                addCount: 0,
            },
            methods: {
                output() {
                    const message = JSON.parse(this.message)
                    const { data: { article, video } } = message
                    const { interestPayAmt: articlePayAmt, statDate: articleStatDate } = article
                    const { interestPayAmt: videoPayAmt } = video
                    const tableData = []
                    for (let index in articleStatDate) {
                        item = {
                            date: this.formData(articleStatDate[index]),
                            articlePay: articlePayAmt[index],
                            videoPay: videoPayAmt[index]
                        }
                        tableData.push(item)
                    }
                    this.tableData = tableData
                },
                articleOutput() {
                    const message = JSON.parse(this.articleMessage)
                    const { data: { strollIpvUv, strollPayOrdByrCnt, strollPv, statDate } } = message
                    const articleTableData = []
                    for (let index in statDate) {
                        item = {
                            date: this.formData(statDate[index]),
                            pvUv: strollIpvUv[index],
                            ordByrCnt: strollPayOrdByrCnt[index],
                            strollPv: strollPv[index]
                        }
                        articleTableData.push(item)
                    }
                    this.articleTableData = articleTableData
                },
                videoOutput() {
                    const message = JSON.parse(this.videoMessage)
                    const { data: { strollIpvUv, strollPayOrdByrCnt, strollPv, statDate } } = message
                    const videoTableData = []
                    for (let index in statDate) {
                        item = {
                            date: this.formData(statDate[index]),
                            pvUv: strollIpvUv[index],
                            ordByrCnt: strollPayOrdByrCnt[index],
                            strollPv: strollPv[index]
                        }
                        videoTableData.push(item)
                    }
                    this.videoTableData = videoTableData
                },
                rivbaoOutput() {
                    const message1 = JSON.parse(this.ribaoMessage1)
                    const message2 = JSON.parse(this.ribaoMessage2)
                    const message3 = JSON.parse(this.ribaoMessage3)
                    //  message1
                    const { data: { video, article } } = message1
                    const { interestPayAmt: videointerestPayAmt, portalContentGuideUv: videoportalContentGuideUv, statDate } = video
                    const { interestPayAmt: articleinterestPayAmt, portalContentGuideUv: articleportalContentGuideUv } = article
                    //  message2 å…¨åº—é‡‘é¢
                    const { content: { data: { payAmt, statDate: statDate2 } } } = message2
                    const { value: payAmtValue } = payAmt
                    //  message3 å…¨åº—è®¿å®¢
                    const { content: { data: { uv, statDate: statDate3 } } } = message3
                    const { value: uvValue } = uv
                    const ribaoTableData = []
                    for (let index in statDate) {
                        let item = {}
                        if (statDate[index] === statDate2[index] && statDate[index] === statDate3[index]) {
                            item.date = this.formday(statDate[index])
                            item.qdcje = payAmtValue[index].toFixed(2) //  å…¨åº—æˆäº¤é¢
                            item.spcje = videointerestPayAmt[index].toFixed(2) //  è§†é¢‘æˆäº¤é¢
                            item.spzb = `${+((Number(videointerestPayAmt[index]) / Number(payAmtValue[index])) * 100).toFixed(2)}%` //   è§†é¢‘å å…¨åº—æˆäº¤é¢
                            item.twcje = articleinterestPayAmt[index].toFixed(2)   //  å›¾æ–‡æˆäº¤é¢
                            item.twzb = `${+((Number(articleinterestPayAmt[index]) / Number(payAmtValue[index])) * 100).toFixed(2)}%` //   å›¾æ–‡å å…¨åº—æˆäº¤é¢
                            item.hjcje = (Number(videointerestPayAmt[index]) + Number(articleinterestPayAmt[index])).toFixed(2)   //  åˆè®¡æˆäº¤é¢
                            item.hjzb = `${+(((Number(videointerestPayAmt[index]) + Number(articleinterestPayAmt[index])) / Number(payAmtValue[index])) * 100).toFixed(2)}%` //   åˆè®¡å å…¨åº—æˆäº¤é¢

                            item.qdfk = uvValue[index].toFixed(2) //  å…¨åº—è®¿å®¢
                            item.spfk = videoportalContentGuideUv[index].toFixed(2) //  è§†é¢‘è®¿å®¢
                            item.spfkzb = `${+((Number(videoportalContentGuideUv[index]) / Number(uvValue[index])) * 100).toFixed(2)}%` //   è§†é¢‘å å…¨åº—è®¿å®¢
                            item.twfk = articleportalContentGuideUv[index].toFixed(2)   //  å›¾æ–‡è®¿å®¢
                            item.twfkzb = `${+((Number(articleportalContentGuideUv[index]) / Number(uvValue[index])) * 100).toFixed(2)}%` //   å›¾æ–‡å å…¨åº—è®¿å®¢
                            item.hjfk = (Number(videoportalContentGuideUv[index]) + Number(articleportalContentGuideUv[index])).toFixed(2)   //  åˆè®¡æˆè®¿å®¢
                            item.hjfkzb = `${+(((Number(videoportalContentGuideUv[index]) + Number(articleportalContentGuideUv[index])) / Number(uvValue[index])) * 100).toFixed(2)}%` //   åˆè®¡å å…¨åº—è®¿å®¢

                        }
                        ribaoTableData.push(item)
                    }
                    this.ribaoTableData = ribaoTableData
                },
                formData(date) {
                    const toMoon = new Date(date)
                    const day = toMoon.getDate()
                    const month = toMoon.getMonth() + 1
                    const year = toMoon.getFullYear()
                    return `${year}/${month}`
                },
                formday(date) {
                    const toMoon = new Date(date)
                    const day = toMoon.getDate()
                    const month = toMoon.getMonth() + 1
                    const year = toMoon.getFullYear()
                    return `${year}/${month}/${day}`
                },
                clickDate() {
                    console.log(this.datetimerange)
                    const start = new Date(this.datetimerange)
                    const oldend = new Date(this.datetimerange)
                    const startday = start.getDate()
                    const startmonth = start.getMonth() + 1
                    const startyear = start.getFullYear()
                    const oldendday = oldend.getDate()
                    const oldendmonth = oldend.getMonth() + 2
                    const oldendyear = oldend.getFullYear()
                    const end = new Date(new Date(`${oldendyear}/${oldendmonth}/${oldendday}`) - 24 * 60 * 60 * 1000)
                    const endday = end.getDate()
                    const endmonth = end.getMonth() + 1
                    const endyear = end.getFullYear()

                    this.link = {
                        cje: `https://sycm.taobao.com/s_content/portal/board/core/trend.json?dateType=month&dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&_=1662277303099&token=b8fbbef21`,
                        twmx: `https://sycm.taobao.com/s_content/stroll/v2/trend.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=month&contentType=tuwen&accountRole=all&indexCode=&_=1662281157809&token=b8fbbef21`,
                        spmx: `https://sycm.taobao.com/s_content/stroll/v2/trend.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=month&contentType=video&accountRole=all&indexCode=&_=1662281157809&token=b8fbbef21`,
                        nrgk: `https://sycm.taobao.com/s_content/portal/board/core/trend.json?dateType=day&dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&_=1662305119999&token=a4a880682`,
                        fks: `https://sycm.taobao.com/portal/coreIndex/getTrend.json?dateType=day&dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&indexCode=uv&device=0&includeRival=true&_=1662305850737&token=a4a880682`
                    }
                },
                clickDateEveryDay() {
                    const start = new Date(this.chooseDate)
                    const oldend = new Date(this.chooseDate)
                    const startday = start.getDate()
                    const startmonth = start.getMonth() + 1
                    const startyear = start.getFullYear()
                    this.linkDay = {
                        rblink1: `https://sycm.taobao.com/s_content/portal/board/core/trend.json?dateType=day&dateRange=${startyear}-${startmonth}-${startday}%7C${startyear}-${startmonth}-${startday}&_=1662389218789&token=49a2032d4`,
                        rblink2: `https://sycm.taobao.com/portal/coreIndex/getTrend.json?dateType=day&dateRange=${startyear}-${startmonth}-${startday}%7C${startyear}-${startmonth}-${startday}&indexCode=payAmt&device=0&includeRival=true&_=1662389761937&token=49a2032d4`,
                        rblink3: `https://sycm.taobao.com/portal/coreIndex/getTrend.json?dateType=day&dateRange=${startyear}-${startmonth}-${startday}%7C${startyear}-${startmonth}-${startday}&indexCode=uv&device=0&includeRival=true&_=1662389630610&token=49a2032d4`
                    }
                },
                clickDateDay() {
                    console.log('this.chooseDate2', this.chooseDate2);
                    const startDate = new Date(this.chooseDate2[0]);
                    const endDate = new Date(this.chooseDate2[1]);
                    const startday = startDate.getDate();
                    const startmonth = startDate.getMonth() + 1;
                    const startyear = startDate.getFullYear();
                    const endday = endDate.getDate();
                    const endmonth = endDate.getMonth() + 1;
                    const endyear = endDate.getFullYear();
                    this.allGoodsParam.url = `https://sycm.taobao.com/cc/long/period/nodistinct/item/view/top.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}%2C${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=compareRange&pageSize=20`;
                    this.selfGoodsParam.url = `https://sycm.taobao.com/s_content/v2/video/single/item/list.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=recent7&pageSize=10`;
                    this.contentGoodsParam.url = `https://sycm.taobao.com/s_content/v2/video/single/item/list.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=recent7&pageSize=10`;
                    this.buyerGoodsParam.url = `https://sycm.taobao.com/s_content/v2/video/single/item/list.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=recent7&pageSize=10`;
                    this.otherGoodsParam.url = `https://sycm.taobao.com/s_content/v2/video/single/item/list.json?dateRange=${startyear}-${startmonth}-${startday}%7C${endyear}-${endmonth}-${endday}&dateType=recent7&pageSize=10`;
                },
                getThisPage(type, index) {
                    let url = ''
                    switch (type) {
                        case 'all':
                            url = `${this.allGoodsParam.url}&page=${index + 1}&order=desc&orderBy=payAmt&device=0&compareType=cycle&keyword=&follow=false&cateId=&cateLevel=&indexCode=payAmt%2CpayItmCnt%2CsucRefundAmt%2CitemCartCnt%2CitmUv&_=1708499132564&token=de3919664`;
                            break;
                        case 'self':
                            url = `${this.selfGoodsParam.url}&page=${index + 1}&order=desc&orderBy=interestPayAmt&keyword=&accountRole=guanghe-seller&indexCode=contentItemClickCnt%2CitemFansClickPv%2CcontentCltTimes%2CcontentCartItmCnt%2CinterestPayAmt&_=1708481342586&token=de3919664`;
                            break;
                        case 'content':
                            url = `${this.contentGoodsParam.url}&page=${index + 1}&order=desc&orderBy=interestPayAmt&keyword=&accountRole=guanghe-busi_coop&indexCode=contentItemClickCnt%2CitemFansClickPv%2CcontentCltTimes%2CcontentCartItmCnt%2CinterestPayAmt&_=1708484855988&token=de3919664`;
                            break;
                        case 'buyer':
                            url = `${this.buyerGoodsParam.url}&page=${index + 1}&order=desc&orderBy=interestPayAmt&keyword=&accountRole=guanghe-ugc&indexCode=contentItemClickCnt%2CitemFansClickPv%2CcontentCltTimes%2CcontentCartItmCnt%2CinterestPayAmt&_=1708484903967&token=de3919664`;
                            break;
                        case 'other':
                            url = `${this.otherGoodsParam.url}&page=${index + 1}&order=desc&orderBy=interestPayAmt&keyword=&accountRole=guanghe-else&indexCode=contentItemClickCnt%2CitemFansClickPv%2CcontentCltTimes%2CcontentCartItmCnt%2CinterestPayAmt&_=1708484942932&token=de3919664`;
                            break;
                        default:
                            break;
                    }
                    window.open(url, "_blank");
                },
                addPage(type) {
                    switch (type) {
                        case 'all':
                            if (this.allGoodsJsons.length > 10) {
                                this.addCount += 1
                                if (this.addCount > 5) {
                                    this.$notify({
                                        title: 'æ–¹å­å…³å¿ƒ',
                                        message: 'æœ‰è¿™ä¹ˆå¤šå‘€~ç»™å…ƒå®æ‰æ‰è‚©',
                                        duration: 0
                                    });
                                }
                            }
                            this.allGoodsJsons.push('');
                            break;
                        case 'self':
                            if (this.selfGoodsJsons.length > 10) {
                                this.addCount += 1
                                if (this.addCount > 5) {
                                    this.$notify({
                                        title: 'ğŸ©·',
                                        message: 'å˜¿å˜¿ï¼Œæœç„¶çˆ±è¿ç»µä¸ç»',
                                        duration: 0
                                    });
                                } else {
                                    this.$notify({
                                        title: 'æ•²çŒªå¤´',
                                        message: 'åˆ«åŠ å•¦ï¼å“ªæœ‰è¿™ä¹ˆå¤šå‘€',
                                        duration: 0
                                    });
                                }
                            } else {
                                this.selfGoodsJsons.push('');
                            }
                            break;
                        case 'content':
                            if (this.contentGoodsJsons.length > 10) {
                                this.addCount += 1
                                if (this.addCount > 5) {
                                    this.$notify({
                                        title: 'ğŸ©·',
                                        message: 'å˜¿å˜¿ï¼Œæœç„¶çˆ±è¿ç»µä¸ç»',
                                        duration: 0
                                    });
                                } else {
                                    this.$notify({
                                        title: 'æ•²çŒªå¤´',
                                        message: 'åˆ«åŠ å•¦ï¼å“ªæœ‰è¿™ä¹ˆå¤šå‘€',
                                        duration: 0
                                    });
                                }
                            } else {
                                this.contentGoodsJsons.push('');
                            }
                            break;
                        case 'buyer':
                            if (this.buyerGoodsJsons.length > 10) {
                                this.addCount += 1
                                if (this.addCount > 5) {
                                    this.$notify({
                                        title: 'ğŸ©·',
                                        message: 'å˜¿å˜¿ï¼Œæœç„¶çˆ±è¿ç»µä¸ç»',
                                        duration: 0
                                    });
                                } else {
                                    this.$notify({
                                        title: 'æ•²çŒªå¤´',
                                        message: 'åˆ«åŠ å•¦ï¼å“ªæœ‰è¿™ä¹ˆå¤šå‘€',
                                        duration: 0
                                    });
                                }
                            } else {
                                this.buyerGoodsJsons.push('');
                            }
                            break;
                        case 'other':
                            if (this.otherGoodsJsons.length > 10) {
                                this.addCount += 1
                                if (this.addCount > 5) {
                                    this.$notify({
                                        title: 'ğŸ©·',
                                        message: 'å˜¿å˜¿ï¼Œæœç„¶çˆ±è¿ç»µä¸ç»',
                                        duration: 0
                                    });
                                } else {
                                    this.$notify({
                                        title: 'æ•²çŒªå¤´',
                                        message: 'åˆ«åŠ å•¦ï¼å“ªæœ‰è¿™ä¹ˆå¤šå‘€',
                                        duration: 0
                                    });
                                }
                            } else {
                                this.otherGoodsJsons.push('');
                            }
                            break;
                        default:
                            break;
                    }
                },
                dataOutput() {
                    if (this.allGoodsJsons.length === 1 && this.allGoodsJsons[0] === '') {
                        this.$notify({
                            title: 'æ•²çŒªå¤´',
                            message: 'çŒªçŒªå…ƒğŸ·ï¼è‡³å°‘è¦å¡«ä¸€ä¸ªâ€œå“ç±»-å…¨éƒ¨å•†å“â€',
                            duration: 0
                        });
                        return
                    }
                    this.initJson();
                },
                initJson() {
                    this.allGoodsJsons.forEach(element => {
                        if (element !== '') {
                            const myJson = JSON.parse(element);
                            this.allGoods = [...this.allGoods, ...myJson.data.data]
                        }
                    });
                    const productSelf = [];
                    const productContent = [];
                    const productBuyer = [];
                    const productOther = [];
                    this.selfGoodsJsons.forEach(element => {
                        const index = productSelf.findIndex(v => v.productId !== element.productId)
                        if (index === -1) {
                            productSelf.push(element);
                        } else {
                            productSelf[index].amount += element.amount;
                            productSelf[index].visitor += element.visitor;
                        }
                    });
                    this.contentGoodsJsons.forEach(element => {
                        const index = productContent.findIndex(v => v.productId !== element.productId)
                        if (index === -1) {
                            productContent.push(element);
                        } else {
                            productContent[index].amount += element.amount;
                            productContent[index].visitor += element.visitor;
                        }
                    });
                    this.buyerGoodsJsons.forEach(element => {
                        const index = productBuyer.findIndex(v => v.productId !== element.productId)
                        if (index === -1) {
                            productBuyer.push(element);
                        } else {
                            productBuyer[index].amount += element.amount;
                            productBuyer[index].visitor += element.visitor;
                        }
                    });
                    this.otherGoodsJsons.forEach(element => {
                        const index = productOther.findIndex(v => v.productId !== element.productId)
                        if (index === -1) {
                            productOther.push(element);
                        } else {
                            productOther[index].amount += element.amount;
                            productOther[index].visitor += element.visitor;
                        }
                    });
                    this.allGoods.forEach(element => {
                        const data = {
                            productId: element.item.itemId, //  å•†å“id
                            productName: element.item.title,    //  å•†å“åç§°
                            payment: element.payAmt.value.toFixed(2),   //  æ€»é‡‘é¢
                            refundAmount: element.sucRefundAmt.value.toFixed(2),    //  é€€æ¬¾é‡‘é¢
                            refundAmountRate: `${+((Number(element.sucRefundAmt.value.toFixed(2)) / Number(element.payAmt.value.toFixed(2))) * 100).toFixed(2)}%`,  //  é€€æ¬¾ç‡
                            allVisitor: element.itmUv.value,
                        }
                        const selfGoodsItem = this.selfGoodsJsons.filter(item => item.productId === element.item.itemId)
                        if (selfGoodsItem.length > 0) {
                            data.selfAmount = selfGoodsItem[0].amount.toFixed(2);
                            data.selfAmountRate = `${+((Number(data.selfAmount) / Number(element.payAmt.value.toFixed(2))) * 100).toFixed(2)}%`;  //  å•†å®¶è‡ªåˆ¶
                            data.selfVisitor = selfGoodsItem[0].visitor.toFixed(2);
                            data.selfVisitorRate = `${+((Number(data.selfVisitor) / Number(data.allVisitor.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                        } else {
                            data.selfAmount = 'æ— æ•°æ®';
                            data.selfAmountRate = 'æ— æ•°æ®';
                            data.selfVisitor = 'æ— æ•°æ®';
                            data.selfVisitorRate = 'æ— æ•°æ®';
                        }
                        const contentGoodsItem = this.contentGoodsJsons.filter(item => item.productId === element.item.itemId)
                        if (contentGoodsItem.length > 0) {
                            data.contentAmount = contentGoodsItem[0].amount.toFixed(2);
                            data.contentAmountRate = `${+((Number(data.contentAmount) / Number(element.payAmt.value.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                            data.contentVisitor = contentGoodsItem[0].visitor.toFixed(2);
                            data.contentVisitorRate = `${+((Number(data.contentVisitor) / Number(data.allVisitor.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                        } else {
                            data.contentAmount = 'æ— æ•°æ®';
                            data.contentAmountRate = 'æ— æ•°æ®';
                            data.contentVisitor = 'æ— æ•°æ®';
                            data.contentVisitorRate = 'æ— æ•°æ®';
                        }
                        const buyerGoodsItem = this.buyerGoodsJsons.filter(item => item.productId === element.item.itemId)
                        if (buyerGoodsItem.length > 0) {
                            data.buyerAmount = buyerGoodsItem[0].amount.toFixed(2);
                            data.buyerAmountRate = `${+((Number(data.buyerAmount) / Number(element.payAmt.value.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                            data.buyerVisitor = buyerGoodsItem[0].visitor.toFixed(2);
                            data.buyerVisitorRate = `${+((Number(data.buyerVisitor) / Number(data.allVisitor.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                        } else {
                            data.buyerAmount = 'æ— æ•°æ®';
                            data.buyerAmountRate = 'æ— æ•°æ®';
                            data.buyerVisitor = 'æ— æ•°æ®';
                            data.buyerVisitorRate = 'æ— æ•°æ®';
                        }
                        const otherGoodsItem = this.otherGoodsJsons.filter(item => item.productId === element.item.itemId)
                        if (otherGoodsItem.length > 0) {
                            data.otherAmount = otherGoodsItem[0].amount.toFixed(2);
                            data.otherAmountRate = `${+((Number(data.otherAmount) / Number(element.payAmt.value.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                            data.otherVisitor = otherGoodsItem[0].visitor.toFixed(2);
                            data.otherVisitorRate = `${+((Number(data.otherVisitor) / Number(data.allVisitor.toFixed(2))) * 100).toFixed(2)}%`;  //  å†…å®¹
                        } else {
                            data.otherAmount = 'æ— æ•°æ®';
                            data.otherAmountRate = 'æ— æ•°æ®';
                            data.otherVisitor = 'æ— æ•°æ®';
                            data.otherVisitorRate = 'æ— æ•°æ®';
                        }
                        this.calculateTableData.push(data)
                    })
                },
                handleChangeSelf(file, fileList) {
                    this.importfxx(file.raw, 'self');
                },
                handleChangeContent(file, fileList) {
                    this.importfxx(file.raw, 'content');
                },
                handleChangeBuyer(file, fileList) {
                    this.importfxx(file.raw, 'buyer');
                },
                handleChangeOther(file, fileList) {
                    this.importfxx(file.raw, 'other');
                },
                importfxx(obj, type) {
                    let _this = this;//å°†å½“å‰thisé‡æ–°æŒ‡å‘ï¼Œä»¥é˜²thisæ”¹å˜
                    // é€šè¿‡DOMå–æ–‡ä»¶æ•°æ®
                    this.file = obj;
                    var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
                    var f = this.file;
                    var reader = new FileReader();
                    //if (!FileReader.prototype.readAsBinaryString) {
                    FileReader.prototype.readAsBinaryString = function (f) {
                        var binary = "";
                        var rABS = false; //æ˜¯å¦å°†æ–‡ä»¶è¯»å–ä¸ºäºŒè¿›åˆ¶å­—ç¬¦ä¸²
                        var pt = this;
                        var wb; //è¯»å–å®Œæˆçš„æ•°æ®
                        var outdata;
                        var reader = new FileReader();
                        reader.onload = function (e) {
                            var bytes = new Uint8Array(reader.result);
                            var length = bytes.byteLength;
                            let arr = [];
                            for (var i = 0; i < length; i++) {
                                binary += String.fromCharCode(bytes[i]);
                            }
                            if (rABS) {
                                wb = XLSX.read(btoa(fixdata(binary)), {
                                    //æ‰‹åŠ¨è½¬åŒ–
                                    type: "base64"
                                });
                            } else {
                                wb = XLSX.read(binary, {
                                    type: "binary"
                                });
                            }
                            outdata = XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]); //outdataå°±æ˜¯ä½ æƒ³è¦çš„ä¸œè¥¿
                            outdata.forEach((item, index) => {
                                if (index > 2) {
                                    let obj = {};
                                    obj.productId = item["__EMPTY_1"];
                                    obj.visitor = Number(item["__EMPTY_20"].replace(/,/g, ''));
                                    obj.amount = Number(item["__EMPTY_28"].replace(/,/g, ''));
                                    switch (type) {
                                        case 'self':
                                            _this.selfGoodsJsons.push(obj)
                                            break;
                                        case 'content':
                                            _this.contentGoodsJsons.push(obj)
                                            break;
                                        case 'buyer':
                                            _this.buyerGoodsJsons.push(obj)
                                            break;
                                        case 'other':
                                            _this.otherGoodsJsons.push(obj)
                                            break;
                                        default:
                                            break;
                                    }
                                }
                            })
                            return arr;
                        };
                        reader.readAsArrayBuffer(f);
                    };

                    if (rABS) {
                        reader.readAsArrayBuffer(f);
                    } else {
                        reader.readAsBinaryString(f);
                    }
                },
                exportFile() {
                    if (this.calculateTableData.length === 0) {
                        this.$notify({
                            title: 'æ–¹å­è­¦å‘Šï¼',
                            message: 'çŒªå¤´ï¼è¦å…ˆç‚¹è¾“å‡ºå“¦',
                            duration: 0
                        });
                        return;
                    }
                    const exportData = JSON.parse(JSON.stringify(this.calculateTableData)).map(obj => {
                        return {
                            "å•†å“ID": obj.productId,
                            "å•†å“åç§°": obj.productName,
                            "æ”¯ä»˜é‡‘é¢": obj.payment,
                            "é€€æ¬¾é‡‘é¢": obj.refundAmount,
                            "é€€æ¬¾ç‡(%)": obj.refundAmountRate,
                            "æ€»è®¿å®¢æ•°": obj.allVisitor,
                            "å•†å®¶è‡ªåˆ¶-æˆäº¤é‡‘é¢": obj.selfAmount,
                            "å•†å®¶è‡ªåˆ¶-æˆäº¤é‡‘é¢å æ¯”(%)": obj.selfAmountRate,
                            "å•†å®¶è‡ªåˆ¶-è®¿å®¢": obj.selfVisitor,
                            "å•†å®¶è‡ªåˆ¶-è®¿å®¢å æ¯”(%)": obj.selfVisitorRate,
                            "å†…å®¹è¥é”€-æˆäº¤é‡‘é¢": obj.contentAmount,
                            "å†…å®¹è¥é”€-æˆäº¤é‡‘é¢å æ¯”(%)": obj.contentAmountRate,
                            "å†…å®¹è¥é”€-è®¿å®¢": obj.contentVisitor,
                            "å†…å®¹è¥é”€-è®¿å®¢å æ¯”(%)": obj.contentVisitorRate,
                            "ä¹°å®¶å†…å®¹-æˆäº¤é‡‘é¢": obj.buyerAmount,
                            "ä¹°å®¶å†…å®¹-æˆäº¤é‡‘é¢å æ¯”(%)": obj.buyerAmountRate,
                            "ä¹°å®¶å†…å®¹-è®¿å®¢": obj.buyerVisitor,
                            "ä¹°å®¶å†…å®¹-è®¿å®¢å æ¯”(%)": obj.buyerVisitorRate,
                            "å…¶ä»–-æˆäº¤é‡‘é¢": obj.otherAmount,
                            "å…¶ä»–-æˆäº¤é‡‘é¢å æ¯”(%)": obj.otherAmountRate,
                            "å…¶ä»–-è®¿å®¢": obj.otherVisitor,
                            "å…¶ä»–-è®¿å®¢å æ¯”(%)": obj.otherVisitorRate,
                        }
                    })
                    const workBook = XLSX.utils.book_new();
                    const workSheet = XLSX.utils.json_to_sheet(exportData);
                    XLSX.utils.book_append_sheet(workBook, workSheet, 'sheet');
                    const startDate = new Date(this.chooseDate2[0]);
                    const endDate = new Date(this.chooseDate2[1]);
                    const startday = startDate.getDate();
                    const startmonth = startDate.getMonth() + 1;
                    const startyear = startDate.getFullYear();
                    const endday = endDate.getDate();
                    const endmonth = endDate.getMonth() + 1;
                    const endyear = endDate.getFullYear();
                    XLSX.writeFile(workBook, `${startyear}${startmonth}${startday}-${endyear}${endmonth}${endday}æ•°æ®å¯¹æ¯”.xlsx`);
                },
            },
            beforeMount() {
                console.log("æŒ‚è½½å‰ç”Ÿå‘½å‘¨æœŸ");
            },
            mounted() {
                console.log("æŒ‚è½½å®Œæˆç”Ÿå‘½å‘¨æœŸ");
                const date = new Date();
                const day = date.getDate();
                const month = date.getMonth() + 1;
                if (month === 3 && day === 12) {
                    this.$notify({
                        title: 'ä»Šå¤©æ˜¯æˆ‘çš„ç”Ÿæ—¥å“¦',
                        message: 'å˜¿å˜¿ï½',
                        duration: 0
                    });
                }
                if (month === 10 && day === 13) {
                    this.$notify({
                        title: 'ğŸ‚ç”Ÿæ—¥å¿«ä¹ï¼ï¼',
                        message: 'ç”Ÿæ—¥å¿«ä¹å‘€ï½å°å…ƒå®',
                        duration: 0
                    });
                }
            },
            watch: {
                'message'() {
                    console.log("ç›‘è§†å™¨è°ƒç”¨");
                }
            }
        })


        // æˆäº¤é¢ https://sycm.taobao.com/s_content/portal/board/core/trend.json?dateType=month&dateRange=2022-08-01%7C2022-08-31&_=1662277303099&token=b8fbbef21
        // å›¾æ–‡æ•°æ®æ˜ç»† https://sycm.taobao.com/s_content/stroll/v2/trend.json?dateRange=2022-08-01%7C2022-08-31&dateType=month&contentType=tuwen&accountRole=all&indexCode=&_=1662281157809&token=b8fbbef21
        // è§†é¢‘æ•°æ®æ˜ç»† https://sycm.taobao.com/s_content/stroll/v2/trend.json?dateRange=2022-08-01%7C2022-08-31&dateType=month&contentType=video&accountRole=all&indexCode=&_=1662282113378&token=b8fbbef21
    </script>
    <style>
        .box-card {
            margin-top: 10px;
            width: 48vw;
        }

        .box-space {
            display: grid;
            grid-template-columns: 1fr 1fr;
            grid-column-gap: 18px;
        }

        .upload-demo {
            width: 100%;
        }
    </style>
</body>

</html>